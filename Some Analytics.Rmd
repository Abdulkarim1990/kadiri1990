---
title: "Analytical Project 1"
author: "Abdul-Karim Kadiri"
date: "2022-11-05"
output:
  word_document: default
  html_document: default
  classoption: landscape
  pdf_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Question one
Collect any data from an industry of interest to you. Read the data in R and apply any
mathematical/statistical technique to fit or understand the relationships among the variables in the data.
Furthermore, use the sink() function to store the commands in the R console/terminal and dev()
function to generate graphs of relationships between at least 2 variables of your data.
Note: include your data in the submission.


```{r}
options(repos = list(CRAN="http://cran.rstudio.com/"))

#The data of interest is an experimental data from Northern Ghana. 
#The study observed the effect of fertilizer, 
#type of maize planted and ecological type on maize yield.

sink('question1.txt')
agric_data <- read.csv("agric_data.csv")



#We begin the analysis with descriptive statistics
summary(agric_data)
names(agric_data)
head(agric_data)
#The variables ecological_type, type_maize_planted and fertilizer, are categorical data.
#However, because of numerical coding the variables are treated as quantitative. 
#We will convert them to factors so they are treated appropriately.
agric_data$ecological_type <- factor(agric_data$ecological_type)
levels(agric_data$ecological_type) <- c("Sudan Savannah", "Guinea Savannah")
summary(agric_data$ecological_type)

agric_data$type_maize_planted <- factor(agric_data$type_maize_planted)
levels(agric_data$type_maize_planted) <- c("Tigli", "Omankwa", "Bihilifa", "Abontem")
summary(agric_data$type_maize_planted)

agric_data$fertilizer <- factor(agric_data$fertilizer)
levels(agric_data$fertilizer) <- c("Organic Fertilizer", "Control", "NPK+Org")
summary(agric_data$fertilizer)

table1::table1(~fertilizer + ecological_type + type_maize_planted +
                 maize_yield, data = agric_data)


library(dplyr)
agric_data %>% group_by(fertilizer) %>%
  summarise(
    count = n(),
    mean(maize_yield),
    median(maize_yield)
   
    
  )

agric_data %>% group_by(ecological_type) %>%
  summarise(
    count = n(),
    mean(maize_yield),
    median(maize_yield)
    
    
  )

agric_data %>% group_by(type_maize_planted) %>%
  summarise(
    count = n(),
    mean(maize_yield),
    median(maize_yield)
    
   
  )
#we plot the histogram for yield against fertilizer.
#We conduct a normality text using histogram and Shapiro.test.
# The null hypothesis states that the population is normally distributed 
#i.e if the p-value is greater than 0.05, then the null hypothesis is accepted.

hist(agric_data$maize_yield)
shapiro.test(agric_data$maize_yield)# The p-value reveal that the data is normally distributed.

#To determine the effect of fertilizer type, type of maize planted on maize yield, we will use Anova. 
#The null hypothesis is, the group means are equal, we begin with a box plot then run the anova
#We begin with a box plot
boxplot(agric_data$maize_yield ~ agric_data$fertilizer, data = agric_data)
boxplot(agric_data$maize_yield ~ agric_data$ecological_type, data = agric_data)
boxplot(agric_data$maize_yield ~ agric_data$type_maize_planted, data = agric_data)

#We ran a one-way ANOVA to check whether fertilizer 
#has an effect on maize yield.
maize_one_way <- aov(agric_data$maize_yield ~ agric_data$fertilizer, data = agric_data)
summary(maize_one_way) # the P-value reveal that fertilizer has a real impact on the yield of the maize.

#What about the other variables? 
#We run a two way analysis of variance to check 
#whether the type of maize planted also have an impact on yield.

maize_two_way <- aov(agric_data$maize_yield ~ agric_data$fertilizer + agric_data$type_maize_planted, data = agric_data)
summary(maize_two_way)
# we noticed that adding type of maize planted seem to make the model better. 
#it reduced the residual variance. Both fertilizer and type of 
#maize planted are significant.

#it could also be possible that the fertilizer affects each of the 
#type of maize planted differently.
affect <- aov(agric_data$maize_yield ~ agric_data$fertilizer*agric_data$type_maize_planted, data = agric_data)
summary(affect)
# the p-value is greater than 0.05, which mean that the fertilizer does not 
#affect the different types of maizes planted



# we use Akaike information criterion to determine which model is fit for purpose

library(AICcmodavg)
model_determ <- list(maize_one_way, maize_two_way, affect)
model.names <- c("one way", "two way", "interaction")
aictab(model_determ, modnames = model.names) 
#it appears that the "two way model" is the best fit. It has the lowest AIC value and 99% of the AIC weight. 
#This means that it explains 99% of the total variation in the maize yield.

plot(maize_two_way)


#Finally, we will run a post-hoc test to enable us to determine 
#which groups are statistically different from one another.
turkey_maize_two_way <- TukeyHSD(maize_two_way)
turkey_maize_two_way 
#we noticed that there is a significant difference between NPK+Org and Organic fertilizer. 
#There is also a significant difference between NPK+Org and the Control. 
#We also noticed significant differences between the types of maize planted i.e., Bihilifa and Omankwa.
sink()

```

Question two
Develop a structure plan or an algorithm to find and display all the prime numbers less than 1000.
Write a function in R to implement this algorithm. Demonstrate the implementation of the function


**Structure Plan**

Generally, prime numbers are numbers greater than 1. They only have two factors, 1 and the number itself. 
This means these numbers cannot be divided by any number other than 1 and the number itself without leaving a remainder. 
E.g. 7 is a prime number because it has only two factors. 1 and 7. 6 is not a prime number, it has 4 factors i.e. 1,2,3,6. 

*Algorithm to find and display all the prime numbers less than 1000*

*Create a list of integers from 2 to n where n is less than 1000: (2, 3, 4, …, n).

*Determine if the numbers are positive by checking if they are greater than zero.

*Initially, let p equals 2, the first prime number.

*Starting from p2, count up in increments of p and mark each of these numbers greater than or equal to p2 itself in the list.
These numbers will be p(p+1), p(p+2), p(p+3), etc.

*Find the first number greater than p in the list that is not marked. If there was no such number. 
stop. 
Otherwise, let p now equal this number (which is the next prime), and repeat from step 3.



```{r}
# This function will find and display all the prime numbers less than 1000

options(width = 300)

karim_prime <- function(lowest_value, highest_value) {
  if (lowest_value >= 0 & highest_value >=0) {
    abdul1 <- c()
    for (p in lowest_value: highest_value) {
      factors <- 0
      for (x in 1:p) {
        if ((p %% x) ==0) {
          factors <- factors + 1
        }
        
      }
      
      if (factors == 2) {
        # print (paste(p, is a prime number. It has only ', factors, 'factors, '))
        abdul1 [length(abdul1)+1] <- p
      }else {
        #print (paste (p, is not a prime number. It has ', factors, 'factors.'))
      }
      
    }
    naayelah <- paste('There are', length(abdul1), 'prime numbers between', 
                      lowest_value, 'and', highest_value)
    naayelah_num <- length(abdul1)
    rim_lst <- abdul1
    
    rim <- list(description = naayelah, abdul1 = abdul1)
    return(rim)
  } else{
    finalresult <- list(description = 'The number range must not include negative numbers.', 
                        ans = NaN, abdul1 = NA)
    return(rim)
  }
  
  
  
}

primefinal <- karim_prime(lowest_value = 1, highest_value = 1000)
print(primefinal)


```

Question three
Two players, A and B, play a certain game. The game is played in turns to choose a number 1, 2 or 3,
which may not be the same as the last number chosen (so if A starts with 2, B may only choose 1 or 3 at
the next move). A starts, and may choose any of the three numbers for the first move. After each move,
the number chosen is added to a common running total. If the total reaches 8 exactly, the player whose
turn it was wins the game. If a player causes the total to go over 8, the other player wins. For example,
suppose A starts with 1 (total 1), B chooses 2 (total 3), A chooses 1 (total 4) and B chooses 2 (total 6). A
would like to play 2 now, to win, but he can’t because B cunningly played it on the last move, so A
chooses 1 (total 7). This is even smarter, because B is forced to play 2 or 3, making the total go over 8
and thereby losing. Write a programme to model each player’s chances of winning, if they always play
at random.
```{r}
options(width = 300)
rim_game <- function(playerA, playerB, winning_value){
  Player_A <- list(Name = playerA, LastPlay = 0)
  Player_B <- list(Name = playerB, LastPlay = 0)
  Winning_Value <- winning_value
  CurrentPlayer <- Player_A
  Game_Score <- 0
  Old_Score <- 0
  Currentplay <- 0
  
  while(Game_Score < Winning_Value){
    Currentplay <- ceiling (runif(1,0,3))
    
    if (Old_Score != Currentplay){
      CurrentPlayer$LastPlay <- Currentplay
      Game_Score <- Game_Score + CurrentPlayer$LastPlay
      
      msg <- paste(CurrentPlayer$Name, 'played', CurrentPlayer$LastPlay, ', Current total is', Game_Score)
      print(msg)
      
      Old_Score <- CurrentPlayer$LastPlay
      
      if (Game_Score != Winning_Value) {
        if(CurrentPlayer$Name == Player_A$Name){
          CurrentPlayer <- Player_B
        }else{
          CurrentPlayer <- Player_A
        }
      }
      
    }else {
      msg <- paste(CurrentPlayer$Name, 'attempted to play', Currentplay, '.', 
                   CurrentPlayer$Name, ' Sorry, you are not allowed to play the same number as the previous player')
      print(msg)
    }
  }
  if (Game_Score == Winning_Value) {
    msg <- paste('Amazing performance, well done!!!', CurrentPlayer$Name, 
                 'You won this round. The score is', Winning_Value)
    return(msg)
  }else {
    msg <- paste('Woow, amazing performance, well done!!!', CurrentPlayer$Name,
                 '!!! You won this round. Your competitor pushed the score to', Winning_Value, '.', 'Great game!!!')
    return(msg)
  }
}
rim_game('Abdul', 'Naayelah', 8)
```


